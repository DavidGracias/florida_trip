{"filter":false,"title":"newInvite.php","tooltip":"/scripts/assignments/newInvite.php","undoManager":{"mark":9,"position":9,"stack":[[{"start":{"row":0,"column":0},"end":{"row":50,"column":2},"action":"insert","lines":["<?php","    if(isset($_POST[\"cancel\"]) && isset($_POST[\"id\"])){","        mysqli_query($conn, \"DELETE FROM `roomInvites` WHERE `id`='\".$_POST[\"id\"].\"'\");","        exit;","    }","","    $inviteeID=$_POST['invitee'];","    $inviterID=$_SESSION['id'];","    $inviteeResult=mysqli_query($conn, \"SELECT * FROM `students` WHERE `studID`='$inviteeID'\");","    $inviterResult=mysqli_query($conn, \"SELECT * FROM `students` WHERE `studID`='$inviterID'\");","","    $inRoom=mysqli_query($conn, \"SELECT * FROM `assignments` WHERE '$inviteeID' in(stud1, stud2, stud3, stud4)\");","    $room=mysqli_query($conn, \"SELECT * FROM `assignments` WHERE '$inviterID' in(stud1, stud2, stud3, stud4)\");","    ","    $rCount=0;","    $room=mysqli_fetch_assoc($room);","    for($x=1; $x <=4; $x++){","        if(!is_null($room[\"stud$x\"]) ) $rCount++;","    }","    $invites=mysqli_query($conn, \"SELECT * FROM `roomInvites` WHERE `inviterID`='$inviterID'\");","    if(4-$rCount== mysqli_num_rows($invites)){","        echo \"You can only send as many invites as there are vacancies in your room.\";","    }","    else if( //student invited exists and isn't in room","        mysqli_num_rows($inviteeResult) == 1 &&","        mysqli_num_rows($inRoom) == 0","    ){","        $inviteeRow=mysqli_fetch_assoc($inviteeResult);","        $inviterRow=mysqli_fetch_assoc($inviteeResult);","        if( $inviterRow['gender'] == 2 || $inviterRow['gender'] !=abs( intval($inviteeRow[\"gender\"])-1) ){","            //makes sure roommates are of the appropriate gender","            ","            $result=mysqli_query($conn, \"SELECT * FROM `roomInvites` WHERE `inviterID`='$inviterID' AND `inviteeID`='$inviteeID'\");","            //Check to see if this is the first invite","            ","            if(mysqli_num_rows($result) == 0){","                mysqli_query($conn, \"INSERT INTO `roomInvites` (`inviterID`, `inviteeID`, `roomID`) VALUES ($inviterID, $inviteeID, \".$room[\"id\"].\")\");","                echo \"You've successfully invited your friend!\";","            }","            else","                echo \"You've already invited this person.\";","        }","        else","            echo \"You can only invite students of the appropriate gender.\";","        ","    }","    else if(mysqli_num_rows($inRoom) !=0)","        echo \"This student is unavailable for roommate requests and may have already joined a room.\";","    else","        echo \"An error has occurred. Please try again later.\";","?>"],"id":1}],[{"start":{"row":20,"column":16},"end":{"row":20,"column":17},"action":"insert","lines":[" "],"id":3}],[{"start":{"row":25,"column":8},"end":{"row":25,"column":11},"action":"insert","lines":["// "],"id":4}],[{"start":{"row":24,"column":44},"end":{"row":24,"column":47},"action":"remove","lines":[" &&"],"id":5}],[{"start":{"row":25,"column":11},"end":{"row":25,"column":14},"action":"insert","lines":[" &&"],"id":6}],[{"start":{"row":25,"column":14},"end":{"row":25,"column":15},"action":"insert","lines":[" "],"id":7}],[{"start":{"row":25,"column":10},"end":{"row":25,"column":11},"action":"remove","lines":[" "],"id":8}],[{"start":{"row":11,"column":0},"end":{"row":12,"column":0},"action":"remove","lines":["    $inRoom=mysqli_query($conn, \"SELECT * FROM `assignments` WHERE '$inviteeID' in(stud1, stud2, stud3, stud4)\");",""],"id":9}],[{"start":{"row":24,"column":0},"end":{"row":25,"column":0},"action":"remove","lines":["        // && mysqli_num_rows($inRoom) == 0",""],"id":10}],[{"start":{"row":44,"column":0},"end":{"row":46,"column":0},"action":"remove","lines":["    else if(mysqli_num_rows($inRoom) !=0)","        echo \"This student is unavailable for roommate requests and may have already joined a room.\";",""],"id":11}]]},"ace":{"folds":[],"scrolltop":352.5,"scrollleft":0,"selection":{"start":{"row":45,"column":51},"end":{"row":45,"column":51},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":26,"state":"php-start","mode":"ace/mode/php"}},"timestamp":1559763415589,"hash":"3462e0e12e702c6bee15879b0bf4d5dc027ee07d"}